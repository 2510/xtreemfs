/*
 * Copyright (c) 2014 by Philippe Lieser, Zuse Institute Berlin
 *
 * Licensed under the BSD License, see LICENSE file for details.
 */

option java_package="org.xtreemfs.pbrpc.generatedinterfaces";
package xtreemfs.pbrpc;

message SymEncBytes {
	required string cipher = 1;
	required bytes iv = 2;
	required bytes ciphertext = 3;
}

message FileLockbox {
	// FileID to which this FileLockbox belongs.
	required string file_id = 1;
	// Salt for the FileID to prevent duplicate FileIDs.
	// Required because server generates FileID, must be generated by client.
	required bytes file_id_salt = 2;
	// The cipher used for encrypting the file.
	// Because the use EtS required to ensure integrity of plaintext.
	required string cipher = 3;
	// File encryption key.
	required bytes enc_key = 4;
	// DER encoder file sign key.
	required bytes sign_key = 5;
}


message SignedFileLockbox {
	// An encoded FileLockbox.
	required bytes lockbox = 1;
	// Signature for the lockbox.
	required bytes signature = 2;
}
